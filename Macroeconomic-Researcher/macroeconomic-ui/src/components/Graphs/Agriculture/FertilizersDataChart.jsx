import React, { useEffect, useState } from "react";
import { Chart } from "react-google-charts";
import { useSelector } from "react-redux";

export const data = [
  ["Year", "China", "India", "United States"],
  ["1960", "0.0", "0.0", "0.0"],
  ["1961", "7.09551656920078", "2.17128993748636", "41.3342780822676"],
  ["1962", "9.67350928641251", "2.88576898532227", "46.7255366893475"],
  ["1963", "12.2135161606268", "3.45399123642599", "51.0648342187622"],
  ["1964", "16.4573110893032", "4.9019856465397", "55.0294807997033"],
  ["1965", "25.6173143138219", "4.95904333316479", "61.038199039548"],
  ["1966", "36.7490118577075", "6.93990793870988", "69.2435058194132"],
  ["1967", "26.7772041302621", "9.63199399173864", "76.2348037962714"],
  ["1968", "26.8954509177973", "10.9996314089549", "76.8567781767956"],
  ["1969", "34.8235765838011", "12.3893584037606", "76.1347999408171"],
  ["1970", "44.3896051571313", "14.0545590433483", "80.6353254563276"],
  ["1971", "46.1952453211937", "16.630361300984", "82.8753588816839"],
  ["1972", "53.3306230307958", "17.2792878279001", "85.7231308219361"],
  ["1973", "65.8067810457516", "17.6256178435707", "91.5438432504678"],
  ["1974", "56.6290879544993", "15.9336474696751", "88.7037791732807"],
  ["1975", "70.6423342612641", "21.5882549215883", "95.6487429211892"],
  ["1976", "66.3200303248235", "21.0839396014982", "105.194879070316"],
  ["1977", "94.5313092652988", "26.5076299372451", "102.81232996698"],
  ["1978", "112.630923986311", "31.4324395518228", "104.885324945035"],
  ["1979", "135.844942081735", "32.2612026137393", "110.179319223332"],
  ["1980", "159.445801923577", "33.9727608778415", "112.830980795211"],
  ["1981", "156.550263456969", "37.3489982321744", "106.99803374745"],
  ["1982", "161.214355948869", "35.9304362740894", "93.2429035762789"],
  ["1983", "173.656104380242", "40.7756310989848", "98.8041361808644"],
  ["1984", "175.985964912281", "48.890708846215", "105.161785316752"],
  ["1985", "143.871773522065", "52.9864253393665", "98.5597665699145"],
  ["1986", "143.760995850622", "58.8559993635601", "93.1496548345006"],
  ["1987", "188.750133111481", "51.1179191813976", "94.8042592951513"],
  ["1988", "209.445037220844", "66.0964707615984", "95.6284273885282"],
  ["1989", "208.086710310966", "69.2107710000245", "98.8001560363115"],
  ["1990", "220.304523424879", "73.523024122257", "100.441282287425"],
  ["1991", "237.51031031031", "77.9993197779167", "100.79727853896"],
  ["1992", "237.607811228641", "74.7016643516527", "102.80303938505"],
  ["1993", "206.754328112119", "76.1767372344482", "108.885530347801"],
  ["1994", "238.956089478045", "83.4558929395478", "108.057701647255"],
  ["1995", "297.543067402576", "85.702855272341", "108.772800444349"],
  ["1996", "301.527581092518", "89.0423288309269", "112.872082555892"],
  ["1997", "299.453331569209", "100.172560813361", "113.862860263976"],
  ["1998", "300.992527690388", "104.067951601212", "112.34110248781"],
  ["1999", "306.107833727809", "112.171020344774", "111.86022626705"],
  ["2000", "287.448487903226", "103.786118188032", "108.751459274212"],
  ["2001", "295.448526102869", "108.182198658974", "110.130264595211"],
  ["2002", "333.508933120848", "100.329055300688", "111.881760060586"],
  ["2003", "328.658254602381", "105.177203862352", "124.189786407062"],
  ["2004", "352.264351239697", "115.271510073208", "119.230505964126"],
  ["2005", "375.104993176394", "127.614591957051", "115.915929274328"],
  ["2006", "374.765136923592", "136.403921543911", "126.65110394555"],
  ["2007", "385.314639755194", "142.835225474934", "120.381693781679"],
  ["2008", "372.658105367898", "153.349390803506", "99.9746373862011"],
  ["2009", "383.967595807046", "167.457295914491", "118.931868033771"],
  ["2010", "425.239347785733", "179.035876924253", "124.700400401987"],
  ["2011", "444.649804769127", "180.748291172705", "130.227726557604"],
  ["2012", "457.333238953802", "163.122021642201", "134.897690369821"],
  ["2013", "458.516151953076", "156.495698086192", "135.555101013543"],
  ["2014", "477.579278064343", "163.498079418137", "127.975219107325"],
  ["2015", "480.242062821883", "171.038212936265", "129.026289363663"],
  ["2016", "474.319184051475", "166.003057888777", "127.815233251268"],
  ["2017", "467.319479918298", "170.569144633223", "127.716580087843"],
  ["2018", "450.371816833147", "176.071313435643", "129.154546878091"],
  ["2019", "399.598971711768", "186.456666096266", "128.840691836021"],
  ["2020", "385.322990859199", "210.657379533459", "131.152168422334"],
  ["2021", "374.805087542026", "193.245040717537", "128.740929573822"],
];

const convertedData = data.map((row, index) => {
  if (index === 0) {
    // Keep the header row as is
    return row;
  } else {
    // Convert numeric strings to numbers
    return row.map((value, columnIndex) =>
      columnIndex === 0 ? value : parseFloat(value)
    );
  }
});

const FertilizersDataChart = () => {
  const [chartData, setchartData] = useState([]);
  const range = useSelector((state) => state.countryRange.range);
  const country = useSelector((state) => state.countryRange.country);
  const filterData = () => {
    let filteredData = [["year", country]];
    let col = 0;
    if (country == "USA") {
      col = 3;
    } else if (country == "INDIA") {
      col = 2;
    } else if (country == "China") {
      col = 2;
    } else {
      setchartData(convertedData);
      return;
    }
    let startYear = range[0];
    let endYear = range[1];
    for (let i = 1; i < convertedData.length; i++) {
      let currYear = convertedData[i][0];
      if (currYear <= endYear && currYear >= startYear) {
        filteredData.push([currYear, convertedData[i][col]]);
      }
    }
    setchartData(filteredData);
  };

  useEffect(() => {
    console.log(range, country);
    filterData();
  }, [range, country]);

  return (
    <div style={{ marginBottom: "20px" }}>
      <Chart
        chartType="LineChart"
        width="100%"
        height="250px"
        data={chartData}
        options={{
          hAxis: {
            format: "#", // Use 'decimal' format to display integers without commas
          },
        }}
      />
    </div>
  );
};
export default FertilizersDataChart;
