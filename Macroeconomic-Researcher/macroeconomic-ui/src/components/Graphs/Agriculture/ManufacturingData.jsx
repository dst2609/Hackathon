import React, { useEffect, useState } from "react";
import { Chart } from "react-google-charts";
import { useSelector } from "react-redux";

export const data = [
  ["Year", "China", "India", "United States"],
  ["1960", "23.1752941976736", "41.7413351235587", "0.0"],
  ["1961", "35.7948551489085", "41.0924821983426", "0.0"],
  ["1962", "38.9864050937876", "39.0659687962443", "0.0"],
  ["1963", "39.8542017143315", "39.8253516773195", "0.0"],
  ["1964", "38.0297979454385", "41.3437167112138", "0.0"],
  ["1965", "37.5490196078431", "39.3846972551206", "0.0"],
  ["1966", "37.1790120188489", "40.3516512370015", "0.0"],
  ["1967", "39.8060416898896", "42.7515580249536", "0.0"],
  ["1968", "41.6432544005504", "42.0860273766471", "0.0"],
  ["1969", "37.5191112017124", "41.5849235839232", "0.0"],
  ["1970", "34.7984383910164", "40.2896134621907", "0.0"],
  ["1971", "33.631812446579", "38.6333911913807", "0.0"],
  ["1972", "32.4165491302304", "38.6268263019975", "0.0"],
  ["1973", "32.9257673608592", "41.6038246201105", "0.0"],
  ["1974", "33.4264596668671", "38.8780587034109", "0.0"],
  ["1975", "31.952623786807", "35.9969148409303", "0.0"],
  ["1976", "32.3596332731045", "34.3120367117779", "0.0"],
  ["1977", "28.9907692307692", "35.7771442643263", "0.0"],
  ["1978", "27.6854178198334", "34.2739627109955", "0.0"],
  ["1979", "30.7032786969509", "32.8255300200728", "0.0"],
  ["1980", "29.6339383575962", "34.4088678062345", "0.0"],
  ["1981", "31.3155812068692", "33.2976974188079", "0.0"],
  ["1982", "32.7857031035218", "32.3267496865056", "0.0"],
  ["1983", "32.5681223829416", "32.6065348775622", "0.0"],
  ["1984", "31.5396955614797", "31.3805304117853", "0.0"],
  ["1985", "27.9343575172623", "29.7181383564993", "0.0"],
  ["1986", "26.6384965309993", "28.6411462697276", "0.0"],
  ["1987", "26.3208996403948", "27.9723784011745", "0.0"],
  ["1988", "25.2376865324238", "28.7698223693608", "0.0"],
  ["1989", "24.611551959103", "27.8396057996888", "0.0"],
  ["1990", "26.5843081183771", "27.5848881365411", "0.0"],
  ["1991", "24.034067384598", "27.6627054102247", "0.0"],
  ["1992", "21.3288613741081", "26.8969194477949", "0.0"],
  ["1993", "19.3074684038403", "27.0545587671255", "0.0"],
  ["1994", "19.4742827285474", "26.519937575032", "0.0"],
  ["1995", "19.5965196106392", "24.4575477898552", "0.0"],
  ["1996", "19.3254855475406", "25.199306058679", "0.0"],
  ["1997", "17.8952767359135", "24.248674505748", "1.33691171038169"],
  ["1998", "17.1590347605501", "24.180451549085", "1.21399691075917"],
  ["1999", "16.0647884669624", "22.9725618865025", "1.15124101558576"],
  ["2000", "14.6762416556975", "21.6110620465121", "1.15055536360653"],
  ["2001", "13.9834613517141", "21.6188848861438", "1.1292569744094"],
  ["2002", "13.3014877124239", "19.5345432709546", "0.973711859673977"],
  ["2003", "12.3489989650344", "19.5919979784251", "1.12104760396265"],
  ["2004", "12.9166481665975", "17.8146906485198", "1.26548363027696"],
  ["2005", "11.6414956028384", "17.6202069550294", "1.1505065593333"],
  ["2006", "10.6257605276952", "16.8094420943196", "1.00948718664602"],
  ["2007", "10.2461657565245", "16.7501197596544", "1.07512397740734"],
  ["2008", "10.1690478477618", "16.7909423596819", "1.05300059714298"],
  ["2009", "9.63618551428879", "16.7442701564476", "0.960285892029002"],
  ["2010", "9.32517694044618", "17.0265090136466", "1.02943733820679"],
  ["2011", "9.17765379525794", "17.1919735579559", "1.20055910284662"],
  ["2012", "9.11371387029059", "16.8453770626628", "1.14932964297306"],
  ["2013", "8.94289396228549", "17.1484235428202", "1.32108416447024"],
  ["2014", "8.64349139635033", "16.7919345138978", "1.17206510494526"],
  ["2015", "8.38701488218385", "16.1745081066756", "1.03393378310334"],
  ["2016", "8.05728753468678", "16.3638005614949", "0.942644552842604"],
  ["2017", "7.46356501656873", "16.5583314050628", "0.946868677532138"],
  ["2018", "7.04302025317327", "16.0316306861012", "0.903900642655548"],
  ["2019", "7.14369027759628", "16.755568302942", "0.838812891431208"],
  ["2020", "7.69864253416333", "18.635531272118", "0.948847431791134"],
  ["2021", "7.24101746939763", "17.3262632465159", "0.959566656543433"],
  ["2022", "7.29999943211008", "16.7308355142151", "0.0"],
  ["2023", "0.0", "0.0", "0.0"],
];

const convertedData = data.map((row, index) => {
  if (index === 0) {
    // Keep the header row as is
    return row;
  } else {
    // Convert numeric strings to numbers
    return row.map((value, columnIndex) =>
      columnIndex === 0 ? value : parseFloat(value)
    );
  }
});

const ManufacturingData = () => {
  const [chartData, setchartData] = useState([]);
  const range = useSelector((state) => state.countryRange.range);
  const country = useSelector((state) => state.countryRange.country);
  const filterData = () => {
    let filteredData = [["year", country]];
    let col = 0;
    if (country == "USA") {
      col = 3;
    } else if (country == "INDIA") {
      col = 2;
    } else if (country == "China") {
      col = 2;
    } else {
      setchartData(convertedData);
      return;
    }
    let startYear = range[0];
    let endYear = range[1];
    for (let i = 1; i < convertedData.length; i++) {
      let currYear = convertedData[i][0];
      if (currYear <= endYear && currYear >= startYear) {
        filteredData.push([currYear, convertedData[i][col]]);
      }
    }
    setchartData(filteredData);
  };

  useEffect(() => {
    console.log(range, country);
    filterData();
  }, [range, country]);

  return (
    <div style={{ marginBottom: "20px" }}>
      <Chart
        chartType="LineChart"
        width="100%"
        height="250px"
        data={chartData}
        options={{
          hAxis: {
            format: "#", // Use 'decimal' format to display integers without commas
          },
        }}
      />
    </div>
  );
};

export default ManufacturingData;
