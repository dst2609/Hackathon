import React, { useEffect, useState } from "react";
import { Chart } from "react-google-charts";
import { useSelector } from "react-redux";

export const data = [
  ["Year", "China", "India", "United States"],
  ["1960", "0.0", "0.0", "0.0"],
  ["1961", "1.40000000551854", "0.0842074450338828", "0.0"],
  ["1962", "4.49999999536237", "-1.98909882496424", "0.0"],
  ["1963", "11.3000000000649", "2.33925222333417", "0.0"],
  ["1964", "12.9000000086735", "9.22427469483067", "0.0"],
  ["1965", "9.69999999537056", "-11.0421970858602", "0.0"],
  ["1966", "7.20000000617421", "-1.42257922345937", "0.0"],
  ["1967", "1.89999999445814", "14.8708722422328", "0.0"],
  ["1968", "-1.59999999121784", "-0.158278985114251", "0.0"],
  ["1969", "0.799999988912688", "6.42751614392773", "0.0"],
  ["1970", "7.70000000468589", "7.09216539598346", "0.0"],
  ["1971", "1.9000000066907", "-1.87736673566218", "0.0"],
  ["1972", "-0.900000011094164", "-5.01847976142427", "0.0"],
  ["1973", "9.0000000017135", "7.20190654772661", "0.0"],
  ["1974", "4.09999999750221", "-1.52335692299658", "0.0"],
  ["1975", "2.00000000872511", "12.8897836515132", "0.0"],
  ["1976", "-1.80000000692547", "-5.7781828190856", "0.0"],
  ["1977", "-2.19999999608014", "10.0362538185643", "0.0"],
  ["1978", "-1.11312087894802", "2.30250676598718", "0.0"],
  ["1979", "6.13443148037291", "-12.7746904609773", "0.0"],
  ["1980", "-1.48246964934704", "12.8882253284047", "0.0"],
  ["1981", "6.98253441197846", "4.60167330174799", "0.0"],
  ["1982", "11.5288242667533", "-0.280834935704419", "0.0"],
  ["1983", "8.32589347156427", "10.1209740847403", "0.0"],
  ["1984", "12.880613447127", "1.58509236760227", "0.0"],
  ["1985", "1.84387944912618", "0.314273271289963", "0.0"],
  ["1986", "3.31868728230391", "-0.409484449567543", "0.0"],
  ["1987", "4.70418468879146", "-1.58779659851746", "0.0"],
  ["1988", "2.54393309848714", "15.6396474795379", "0.0"],
  ["1989", "3.074999732142", "1.18915474202204", "0.0"],
  ["1990", "7.32773213835434", "4.01509580547868", "0.0"],
  ["1991", "2.35353019392093", "-1.95248823583243", "0.0"],
  ["1992", "4.65100301883832", "6.65100678352499", "0.0"],
  ["1993", "4.64917941059286", "3.32270683139868", "0.0"],
  ["1994", "3.94554573547386", "4.71598013566729", "0.0"],
  ["1995", "4.9426425383196", "-0.69537706820789", "0.0"],
  ["1996", "5.03989389977062", "9.92029924219351", "0.0"],
  ["1997", "3.43664044543479", "-2.55372784056674", "0.0"],
  ["1998", "3.43299456648786", "6.32045445805794", "2.65725568136641"],
  ["1999", "2.73137330210611", "2.6691273484422", "11.3574709372423"],
  ["2000", "2.32851803699535", "-0.0076181448506673", "13.7941871241996"],
  ["2001", "2.6380712380831", "6.00708956915695", "-3.75812710123627"],
  ["2002", "2.69994655178539", "-6.60423450583676", "-6.15514843606495"],
  ["2003", "2.3720563695443", "9.04858115641309", "10.0494820073655"],
  ["2004", "6.10501996773056", "0.183532763642177", "4.43860167796051"],
  ["2005", "5.07391439843714", "4.80936404589063", "12.3681538098069"],
  ["2006", "4.75527829821041", "2.9387954888941", "-5.22835167564838"],
  ["2007", "3.52364990248279", "5.50647662855769", "-14.0472412574019"],
  ["2008", "5.15600466645756", "-0.244194258742823", "-2.00762403457476"],
  ["2009", "4.00242578086684", "-0.880233001776233", "12.2596326410097"],
  ["2010", "4.2510696855083", "8.79175828352552", "-2.54617834027003"],
  ["2011", "4.17428925252833", "6.39780625696848", "-6.50313002969247"],
  ["2012", "4.46654195569825", "1.48746049337643", "-3.18808420062585"],
  ["2013", "3.80719982871641", "5.57047566060827", "15.7245101509429"],
  ["2014", "4.05046823694792", "-0.216448196878247", "0.793427336844061"],
  ["2015", "3.8985214657053", "0.649599318002899", "7.2801897272639"],
  ["2016", "3.27781355718643", "6.79755863034326", "7.39063913377113"],
  ["2017", "3.96129100014851", "6.60592151598361", "-2.76564498166104"],
  ["2018", "3.48291749991172", "2.0964660055179", "3.55946665051685"],
  ["2019", "3.07679355990236", "6.16030915250403", "-0.983828934748331"],
  ["2020", "3.13108456167551", "4.11173162047542", "12.7328668449216"],
  ["2021", "7.07379636483387", "3.50594637273376", "-19.480247990835"],
  ["2022", "4.1328656548591", "3.96193431000601", "0.0"],
  ["2023", "0.0", "0.0", "0.0"],
];

const convertedData = data.map((row, index) => {
  if (index === 0) {
    // Keep the header row as is
    return row;
  } else {
    // Convert numeric strings to numbers
    return row.map((value, columnIndex) =>
      columnIndex === 0 ? value : parseFloat(value)
    );
  }
});

console.log(convertedData);

const ForestFishery = () => {
  const [chartData, setchartData] = useState([]);
  const range = useSelector((state) => state.countryRange.range);
  const country = useSelector((state) => state.countryRange.country);
  const filterData = () => {
    let filteredData = [["year", country]];
    let col = 0;
    if (country == "USA") {
      col = 3;
    } else if (country == "INDIA") {
      col = 2;
    } else if (country == "China") {
      col = 2;
    } else {
      setchartData(convertedData);
      return;
    }
    let startYear = range[0];
    let endYear = range[1];
    for (let i = 1; i < convertedData.length; i++) {
      let currYear = convertedData[i][0];
      if (currYear <= endYear && currYear >= startYear) {
        filteredData.push([currYear, convertedData[i][col]]);
      }
    }
    setchartData(filteredData);
  };

  useEffect(() => {
    console.log(range, country);
    filterData();
  }, [range, country]);

  return (
    <div style={{ marginBottom: "20px" }}>
      <Chart
        chartType="LineChart"
        width="100%"
        height="250px"
        data={chartData}
        options={{
          hAxis: {
            format: "#", // Use 'decimal' format to display integers without commas
          },
        }}
      />
    </div>
  );
};

export default ForestFishery;
