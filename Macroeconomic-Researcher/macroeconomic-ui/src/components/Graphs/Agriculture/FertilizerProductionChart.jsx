import React, { useEffect, useState } from "react";
import { Chart } from "react-google-charts";
import { useSelector } from "react-redux";

export const data = [
  ["Year", "China", "India", "United States"],
  ["1960", "0.0", "0.0", "0.0"],
  ["1961", "193.617021276596", "153.983404567158", "92.0163994330786"],
  ["1962", "175.150442477876", "160.074196266115", "93.6281842045712"],
  ["1963", "160.282776349614", "166.395408600308", "92.3455844914401"],
  ["1964", "141.399662731872", "206.61090773054", "92.1036074485094"],
  ["1965", "136.406495547407", "219.967534743152", "90.5368409452778"],
  ["1966", "142.70913277053", "242.049703100946", "93.2007828251877"],
  ["1967", "146.496469310158", "252.419222568476", "94.6423494130203"],
  ["1968", "200.595238095238", "226.835867044576", "97.6147417725072"],
  ["1969", "174.748490945674", "207.691501624227", "97.5626630552546"],
  ["1970", "167.248576850095", "212.766358664907", "96.3880432579644"],
  ["1971", "141.857719788754", "214.344493747479", "98.0701303226618"],
  ["1972", "132.639029322548", "199.87723859041", "96.4481646769452"],
  ["1973", "132.561201398889", "206.526484284051", "96.4528579958317"],
  ["1974", "124.652358596021", "169.541441560153", "96.6335871355962"],
  ["1975", "123.075264954194", "191.158286370849", "97.886023763789"],
  ["1976", "115.926327193933", "145.600204542549", "102.153905990428"],
  ["1977", "120.922812127631", "160.314972383938", "101.212906490765"],
  ["1978", "120.243564904511", "173.052276559865", "94.6439884788221"],
  ["1979", "119.125802485999", "175.47672135512", "92.3978025590901"],
  ["1980", "121.004829240578", "183.053202752779", "91.1041270479531"],
  ["1981", "118.638427810836", "148.029388867264", "104.916435636364"],
  ["1982", "122.618931875463", "132.351481127137", "97.3572473447145"],
  ["1983", "129.625661752941", "145.032608567361", "94.5563640672783"],
  ["1984", "131.860215972501", "152.249667071618", "88.4347125582229"],
  ["1985", "125.165702033336", "150.141679381483", "101.709670623798"],
  ["1986", "121.198043838722", "135.56441783599", "81.8563436139842"],
  ["1987", "132.947554086679", "116.262330584029", "77.4742959655066"],
  ["1988", "142.468394312946", "119.232759070412", "75.8420809564475"],
  ["1989", "138.505343428291", "132.118677120043", "79.1859395848617"],
  ["1990", "142.365653138458", "132.502493379837", "76.8450926284561"],
  ["1991", "147.998762481225", "128.751462074966", "73.0166802824594"],
  ["1992", "140.707989290928", "124.391689432834", "73.8439282397471"],
  ["1993", "126.081538824897", "135.275568379785", "78.0950270800628"],
  ["1994", "134.747265483602", "129.282937810091", "75.9099199969111"],
  ["1995", "140.359306759892", "122.323912218476", "77.3015095947161"],
  ["1996", "132.866724381081", "128.156746926633", "74.9435460311573"],
  ["1997", "132.905267912982", "122.984938510516", "83.4668979833265"],
  ["1998", "125.913691312904", "122.865994285005", "84.8611554054349"],
  ["1999", "123.601402758388", "126.089684435893", "95.3829620714631"],
  ["2000", "119.973871975485", "113.68746025741", "106.15279564166"],
  ["2001", "118.125187360952", "118.59459311618", "102.811241348103"],
  ["2002", "125.729831846451", "113.401275032345", "108.69341486428"],
  ["2003", "112.272776857806", "119.961055081536", "130.333090182729"],
  ["2004", "109.75432319526", "121.48632440882", "120.358072561072"],
  ["2005", "114.500634434033", "132.896008909816", "118.474621289472"],
  ["2006", "109.319755385562", "152.551053782092", "128.148696761254"],
  ["2007", "100.601694779151", "172.230339025303", "117.530450671532"],
  ["2008", "98.1899672140489", "188.965017924367", "108.366007404721"],
  ["2009", "95.5971771350347", "181.231008642721", "135.3823402813"],
  ["2010", "93.0317144481009", "171.491764074282", "128.711123778198"],
  ["2011", "93.5082924263443", "171.196237140606", "131.050216227053"],
  ["2012", "93.9837876273356", "159.54027888951", "133.628071149749"],
  ["2013", "92.6934686160538", "149.517841984085", "127.151943147327"],
  ["2014", "87.4530852563535", "154.546113601489", "121.210471934582"],
  ["2015", "84.766663212593", "149.441673137188", "123.115598940024"],
  ["2016", "91.1512611991474", "144.728520036811", "117.267979815222"],
  ["2017", "100.445150527601", "146.530556014768", "110.404233304274"],
  ["2018", "103.146593673846", "152.701187574258", "109.304070775873"],
  ["2019", "82.5133297829776", "156.483317038389", "105.437340325252"],
  ["2020", "87.82104751252", "176.042247195875", "106.467421211241"],
  ["2021", "83.4204045794174", "160.62028102616", "112.265836006374"],
  ["2022", "0.0", "0.0", "0.0"],
  ["2023", "0.0", "0.0", "0.0"],
];

const convertedData = data.map((row, index) => {
  if (index === 0) {
    // Keep the header row as is
    return row;
  } else {
    // Convert numeric strings to numbers
    return row.map((value, columnIndex) =>
      columnIndex === 0 ? value : parseFloat(value)
    );
  }
});

console.log(convertedData);

const FertilizerProductionChart = () => {
  const [chartData, setchartData] = useState([]);
  const range = useSelector((state) => state.countryRange.range);
  const country = useSelector((state) => state.countryRange.country);
  const filterData = () => {
    let filteredData = [["year", country]];
    let col = 0;
    if (country == "USA") {
      col = 3;
    } else if (country == "INDIA") {
      col = 2;
    } else if (country == "China") {
      col = 2;
    } else {
      setchartData(convertedData);
      return;
    }
    let startYear = range[0];
    let endYear = range[1];
    for (let i = 1; i < convertedData.length; i++) {
      let currYear = convertedData[i][0];
      if (currYear <= endYear && currYear >= startYear) {
        filteredData.push([currYear, convertedData[i][col]]);
      }
    }
    setchartData(filteredData);
  };

  useEffect(() => {
    console.log(range, country);
    filterData();
  }, [range, country]);

  return (
    <div style={{ marginBottom: "20px" }}>
      <Chart
        chartType="LineChart"
        width="100%"
        height="250px"
        data={chartData}
        options={{
          hAxis: {
            format: "#", // Use 'decimal' format to display integers without commas
          },
        }}
      />
    </div>
  );
};
export default FertilizerProductionChart;
